<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eternal SMP - OC Registration</title>

<!-- Cinzel (judul) -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap">

<!-- Font Awesome (semua ikon) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">

  <style>
.form-columns {
  display: flex;
  flex-wrap: wrap;
  gap: 24px;
}
.form-left, .form-right {
  flex: 1 1 0%;
  min-width: 0;
}
.fas {
  font-family: "Font Awesome 6 Free";
  font-weight: 900;
}

.far {
  font-family: "Font Awesome 6 Free";
  font-weight: 400;
}

.fab {
  font-family: "Font Awesome 6 Brands";
  font-weight: 400;
}
@media (max-width: 600px) {
  .logo-img {
    max-width: 220px;
    margin-bottom: 16px;
  }
}
body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: url('https://i.ibb.co/kDVbcQD/medieval-bg.jpg') no-repeat center center fixed;
      background-size: cover;
      background-color: #111;
      color: #ffd700;
      font-family: 'MedievalSharp', cursive;
      overflow-x: hidden;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Cinzel', serif;
      text-shadow: 0 0 10px #ffd700, 0 0 20px #ffaa00;
    }

    header {
      background-color: #000;
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #333;
    }

    .logo {
      font-family: 'Cinzel', serif;
      font-size: 24px;
      color: #ffd700;
      animation: glow 20s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 5px #ffd700, 0 0 10px #ffae00; }
      to { text-shadow: 0 0 20px #fff000, 0 0 30px #ffaa00; }
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 2rem;
      border: 2px solid #ffd700;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.7);
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
      animation: fadeInUp 0.8s ease;
    }

    .logo-img {
      display: block;
      max-width: 500px;
      width: 100%;
      margin: 0 auto 32px;
      animation: float 3s ease-in-out infinite;
      border-radius: 12px;
      transition: transform 0.6s ease;
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
      100% { transform: translateY(0px); }
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .btn {
      font-family: 'MedievalSharp', cursive;
      background: #111;
      border: 1px solid #ffd700;
      color: #ffd700;
      padding: 10px 20px;
      border-radius: 12px;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 0 10px #ffd700;
      animation: pulseGlow 2s infinite;
    }

    .btn:hover {
      background: #ffd700;
      color: #111;
    }

    @keyframes pulseGlow {
      0% { box-shadow: 0 0 6px rgba(255, 215, 0, 0.4); }
      50% { box-shadow: 0 0 12px rgba(255, 215, 0, 0.7); }
      100% { box-shadow: 0 0 6px rgba(255, 215, 0, 0.4); }
    }

    textarea, select, input {
      width: 100%;
      background: #000;
      color: #ffd700;
      padding: 15px;
      border: 2px solid #555;
      border-radius: 9px;
      margin-bottom: 6px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-bottom: 6px;
    }

    pre {
      background: #000;
      padding: 20px;
      border: 1px solid #ffd700;
      border-radius: 10px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    ul.social {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
      padding: 0;
    }

    ul.social li a {
      color: #ffd700;
      font-size: 24px;
      transition: transform 0.3s, text-shadow 0.3s;
    }

    ul.social li a:hover {
      transform: scale(1.2);
      color: white;
      text-shadow: 0 0 8px #ffd700;
}
    .form-columns {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
    }

    .form-left, .form-right {
      flex: 1 1 0%;
      min-width: 300px;
    }

    .hidden { display: none; }

    footer {
      background: #000;
      color: #999;
      text-align: center;
      padding: 40px 20px;
      margin-top: auto;
    }

    @media (max-width: 600px) {
      .logo-img { max-width: 220px; margin-bottom: 16px; }
      .btn { width: 100%; }
    }
    .contact-dot-btn {
      background-color: #ffd700;
      color: #000;
      font-size: 12px;
      padding: 6px 16px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
  }

  body {
    min-height: 100vh;
    background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
    background-repeat: no-repeat;
    background-size: cover;
    background-attachment: fixed;
    color: #fff;
    font-family: sans-serif;
  }

  .container {
    min-height: 100vh;
    padding: 2rem;
  }
    footer {
      margin-top: auto;
}
    .form-columns {
      display: flex;
      gap: 24px;
      flex-wrap: wrap;
}

    .form-left, .form-right {
      flex: 1;
      min-width: 300px;
}
        @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
  }
  to {
        opacity: 1;
        transform: translateY(0);
  }
}

    @keyframes pulseGlow {
      0% {
        box-shadow: 0 0 6px rgba(255, 215, 0, 0.4);
  }
      50% {
        box-shadow: 0 0 12px rgba(255, 215, 0, 0.7);
  }
      100% {
        box-shadow: 0 0 6px rgba(255, 215, 0, 0.4);
  }
}

    .genshin-btn {
      position: relative;
      padding: 10px 18px;
      border: 2px solid #ffd700;
      background-color: transparent;
      color: #ffd700;
      border-radius: 12px;
      font-size: 20px;
      font-weight: bold;
      font-family: 'Cinzel', serif;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
      overflow: hidden;
      animation: fadeInUp 0.8s ease-out, pulseGlow 2s infinite;
}

.    .genshin-btn {
      padding: 6px 12px;
      font-size: 13px;
      border-radius: 8px;
      background-color: #111;
      color: #ffd700;
      border: 1px solid #ffd700;
      font-family: 'Cinzel', serif;
      cursor: pointer;
      transition: all 0.2s;
}

    .genshin-btn:hover {
      background-color: #ffd700;
      color: #000;
}
    .genshin-btn {
      padding: 6px 12px;
      font-size: 13px;
      border-radius: 8px;
      background-color: #111;
      color: #ffd700;
      bottom: ;order: 1px solid #ffd700;
      font-family: 'Cinzel', serif;
      cursor: pointer;
      transition: all 0.2s;
}

    .genshin-btn:hover {
      background-color: #ffd700;
      color: #000;
}
    .menu-container {
      position: relative;
}

    .menu-icon {
      background: none;
      border: none;
      color: #ffd700;
      font-size: 26px;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: background 0.3s;
      z-index: 1100;
}

    .menu-icon:hover {
      background-color: rgba(255, 215, 0, 0.1);
}

    .dropdown-menu {
      position: absolute;
      top: 60px;
      right: 20px;
      background-color: #000;
      border: 1px solid #ffd700;
      border-radius: 10px;
      padding: 8px 0;
      display: flex;
      flex-direction: column;
      width: 180px;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
}

    .dropdown-menu.hidden {
      display: none;
}

    .dropdown-menu a {
      color: #ffd700;
      padding: 12px 16px;
      text-decoration: none;
      font-family: 'Cinzel', serif;
      font-size: 15px;
      transition: background 0.2s, color 0.2s;
}

    .dropdown-menu a:hover {
      background-color: rgba(255, 215, 0, 0.1);
      color: white;
};
}
    header {
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      z-index: 100;
}
    .home-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: calc(100vh - 120px); /* Tengah layar, kurangi header/footer */
      text-align: center;
      gap: 24px;
}

    .logo-img {
      max-width: 900px;
      width: 100%;
      height: auto;
      border-radius: 100px;
      animation: float 10s ease-in-out infinite;
}

    .home-text h1 {
      font-family: 'Cinzel', serif;
      font-size: 25px;
      color: #ffd700;
      margin: 0;
}

    .home-text p {
      font-size: 12px;
      color: #eee;
      line-height: 1.6;
      max-width: 700px;
      margin: 0 auto;
}

    .btn {
      font-size: 20px;
      padding: 12px 24px;
      border-radius: 10px;
}
        @media (max-width: 768px) {
      .form-columns {
        flex-direction: column;
  }

      .form-left,
      .form-right {
        width: 100%;
        min-width: unset;
        padding: 0;
  }

      .home-content {
        flex-direction: column;
        text-align: center;
        padding: 0 16px;
  }

      .logo-img {
        width: 100%;
        max-width: 280px;
        margin: 0 auto 20px;
  }

      .home-text h1 {
        font-size: 20px;
  }

      .home-text p {
        font-size: 14px;
        padding: 0 12px;
  }

      .btn {
        width: 100%;
        font-size: 18px;
        padding: 12px;
        box-sizing: border-box;
  }

      .menu-icon {
        position: absolute;
        top: 16px;
        right: 16px;
        display: block;
  }

      .dropdown-menu {
        top: 60px;
        right: 12px;
        width: 100%;
        max-width: 220px;
  }

      .container {
        padding: 24px 16px;
  }
}
  .form-columns {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
  }

  .form-left, .form-right {
    flex: 1 1 0%;
    min-width: 0;
  }

  @import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css");

  .far {
    font-family: "Font Awesome 6 Free";
    font-weight: 400;
  }

  .fas {
    font-family: "Font Awesome 6 Free";
    font-weight: 900;
  }

  .fab {
    font-family: "Font Awesome 6 Brands";
    font-weight: 400;
  }
</style>
</head>
<body>
  <!-- Suara klik -->
  <audio id="clickSound" src="https://raw.githubusercontent.com/marcellnw/eternalsmp-pendaftaran-oc/main/click.m4a"></audio>
  <audio id="Click2Sound" src="https://raw.githubusercontent.com/marcellnw/eternalsmp-pendaftaran-oc/main/Click2.m4a"></audio>

  <!-- Header dengan logo dan menu -->
  <header style="position: relative;">
    <div class="logo">EternalSMP</div>

    <!-- Tombol menu -->
    <button class="menu-icon" onclick="toggleMenu()">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Dropdown menu -->
    <div id="menuDropdown" class="dropdown-menu hidden">
      <a href="#" onclick="playClick(); openContactPage();">Tanya Admin</a>
      <a href="#" onclick="playClick(); openStatsPage();">Statistik Pendaftaran</a>
    </div>
  </header>

<!-- Halaman Home -->
<div class="container active" id="homePage">
  <div class="home-content">
    <img src="https://raw.githubusercontent.com/marcellnw/Gambar/main/20250702_183405.png"
         class="logo-img"
         alt="Eternal SMP Logo" />

    <div class="home-text">
      <h1 style="font-family: 'Cinzel', serif; color: #ffd700; font-size: 28px; margin-top: 0;">The Great Fearssade</h1>
      <p>
        Selamat datang di <strong>Eternal SMP Season 14</strong>, dunia fantasi tempat kisah dan karakter ciptaanmu akan hidup dan berkembang!  
        Daftarkan karaktermu sekarang dan jadilah bagian dari petualangan epik yang tak terlupakan.
      </p>
      <div style="margin-top: 20px;">
        <button class="btn" onclick="playClick(); openForm()">Daftar Sekarang</button>
      </div>
    </div>
  </div>
</div>

<!-- Halaman Form -->
<div class="container hidden" id="formPage">
  <h2>Pendaftaran Karakter OC</h2>
  <form id="ocForm">
    <div class="form-columns">
      <!-- Kiri -->
      <div class="form-left">
        <label for="gamertag">Nama Gamertag</label>
        <input type="text" id="gamertag" name="gamertag" required>

        <label for="ocname">Nama Karakter OC *</label>
        <input type="text" id="ocname" name="ocname" required>

        <label for="race">Ras</label>
        <select id="race" name="race" required>
          <option value="">-- Pilih --</option>
          <option value="Euria">Euria - Peri cahaya, penjaga alam</option>
          <option value="Graveth">Graveth - Ras kuat ahli sihir gelap</option>
          <option value="Maredien">Maredien - Bangsawan diplomatis</option>
          <option value="Heretic">Heretic - Pemilik sihir terlarang</option>
          <option value="Diablonic">Diablonic - Iblis haus kuasa</option>
          <option value="Laurian">Laurian - Pemburu & pelindung hutan</option>
        </select>

        <label for="class">Class</label>
        <select id="class" name="class" required>
          <option value="">-- Pilih --</option>
          <option>Warrior - Petarung seimbang</option>
          <option>Berserker - Liar & brutal</option>
          <option>Tank - Pertahanan tinggi</option>
          <option>Lancer - Cepat & menusuk</option>
          <option>Rogue - Licik & lincah</option>
          <option>Hunter - Jarak jauh</option>
          <option>Ronin - Pendekar bebas</option>
          <option>Swordmage - Pedang & sihir</option>
          <option>Priest - Penyembuh</option>
        </select>
      </div>

      <!-- Kanan -->
      <div class="form-right">
        <label for="job">Job</label>
        <select id="job" name="job" required>
          <option value="">-- Pilih --</option>
          <option>Alchemist - Pembuat ramuan</option>
          <option>Blacksmith - Pandai besi</option>
          <option>Trader - Ahli jual beli</option>
          <option>Farmer - Petani</option>
          <option>Nitwit - Awal tanpa keahlian</option>
        </select>

        <label for="role">Role Sosial</label>
        <select id="role" name="role" required>
          <option value="">-- Pilih --</option>
          <option>Raja - Pemimpin utama</option>
          <option>Bangsawan - Tokoh berpengaruh</option>
          <option>Royalis - Pendukung kerajaan</option>
          <option>Worker - Rakyat biasa</option>
        </select>

        <label for="image">Upload Gambar Karakter</label>
        <input type="file" id="image" name="image" accept="image/*" />

        <label for="sifat">Sifat & Kepribadian</label>
        <textarea id="sifat" name="sifat" minlength="50" required></textarea>
      </div>
    </div>

    <label for="lore">Lore & Background</label>
    <textarea id="lore" name="lore" minlength="100" required></textarea>

    <label for="tujuan">Tujuan & Motivasi</label>
    <textarea id="tujuan" name="tujuan" minlength="50" required></textarea>

    <div style="text-align:center">
      <button type="button" class="btn" onclick="playClick(); showPreview()">Preview</button>
      <button type="button" class="btn" onclick="playClick2(); backToHome()">Kembali</button>
    </div>
  </form>
</div>

<!-- Preview Page -->
<div class="container hidden" id="previewPage">
  <h2>Preview Karakter OC</h2>
  <pre id="previewContent"></pre>
  <div style="text-align:center">
    <button class="btn" onclick="playClick2(); backToForm()">Kembali ke Formulir</button>
    <button class="btn" onclick="playClick(); submitToDiscord()">Kirim Pendaftaran</button>
  </div>
</div>

<!-- Contact Page -->
<div class="container hidden" id="contactPage">
  <h2 style="font-family: 'Cinzel', serif; font-size: 28px; color: #ffd700; text-align: center; margin-bottom: 24px;">
    Tanya Admin
  </h2>

  <div style="display: flex; flex-direction: column; gap: 16px;">
    <div style="background:#000; border:1px solid #ffd700; border-radius:8px; padding:16px; display:flex; align-items:center; gap:12px;">
      <i class="fab fa-whatsapp" style="color:#25d366; font-size:20px;"></i>
      <span>WhatsApp: <a href="https://wa.me/6281323146137" style="color:#ffd700;" target="_blank">0813-2314-6137</a></span>
    </div>

    <div style="background:#000; border:1px solid #ffd700; border-radius:8px; padding:16px; display:flex; align-items:center; gap:12px;">
      <i class="fab fa-whatsapp" style="color:#25d366; font-size:20px;"></i>
      <span>Saluran WhatsApp: <a href="https://whatsapp.com/channel/0029VasHyz0DuMRgOX5yOt45" style="color:#ffd700;" target="_blank">Gabung Saluran</a></span>
    </div>

    <div style="background:#000; border:1px solid #ffd700; border-radius:8px; padding:16px; display:flex; align-items:center; gap:12px;">
      <i class="fab fa-instagram" style="color:#e4405f; font-size:20px;"></i>
      <span>Instagram: <a href="https://instagram.com/eternalsmp" style="color:#ffd700;" target="_blank">@eternalsmp</a></span>
    </div>

    <div style="background:#000; border:1px solid #ffd700; border-radius:8px; padding:16px; display:flex; align-items:center; gap:12px;">
      <i class="fab fa-discord" style="color:#5865f2; font-size:20px;"></i>
      <span>Discord: <a href="https://discord.gg/YCGvq8W3Bp" style="color:#ffd700;" target="_blank">Join Server</a></span>
    </div>

    <div style="background:#000; border:1px solid #ffd700; border-radius:8px; padding:16px; display:flex; align-items:center; gap:12px;">
      <i class="fas fa-globe" style="color:#ffd700; font-size:20px;"></i>
      <span>Website: <a href="https://eternalsmp.vercel.app" style="color:#ffd700;" target="_blank">eternalsmp.vercel.app</a></span>
    </div>
  </div>

  <div style="text-align:center; margin-top:32px;">
    <button class="btn" onclick="playClick2(); backToHome()">Kembali</button>
  </div>
</div>

<!-- Stats Page (DIPISAH dari contactPage) -->
<div class="container hidden" id="statsPage">
  <h2 style="font-family: 'Cinzel', serif; color: #ffd700; text-align: center;">
    Statistik Pendaftaran
  </h2>
  <div id="statsContent" style="margin: 20px 0;"></div>

  <div style="text-align: center; margin-top: 24px;">
    <button class="btn" onclick="playClick2(); backToHome()">Kembali</button>
  </div>
</div>

<div class="container hidden" id="statsPage">
  <h2 style="font-family: 'Cinzel', serif; color: #ffd700; font-size: 28px; text-align:center;">
    Statistik Pendaftaran
  </h2>

  <div id="statsSummary" style="text-align:center; font-size:18px; margin-bottom:24px;">
    <!-- Diisi via JavaScript -->
  </div>

  <div id="statsContent" style="font-size:15px; color:#fff; background:#000; padding:20px; border-radius:12px; border:1px solid #ffd700; max-height:400px; overflow-y:auto;">
    <!-- Data list pendaftar akan tampil di sini -->
  </div>

  <div style="text-align:center; margin-top:32px;">
    <button class="btn" onclick="playClick2(); backToHome()">Kembali ke Halaman Utama</button>
  </div>
</div>

<footer>
  <p>&copy; 2025 Eternal SMP. All rights reserved.</p>
  <ul class="social">
    <li><a href="https://instagram.com/eternalsmp"><i class="fab fa-instagram"></i></a></li>
    <li><a href="https://youtube.com/@eternalsmpserver"><i class="fab fa-youtube"></i></a></li>
    <li><a href="https://www.tiktok.com/@eternalsmpserver"><i class="fab fa-tiktok"></i></a></li>
  </ul>
</footer>

<script>
  // 🔊 Suara Klik
  function playClick() {
    document.getElementById("clickSound").play();
  }
  function playClick2() {
    document.getElementById("Click2Sound").play();
  }

  // 🔀 Navigasi Halaman
  function showPage(pageId) {
    document.querySelectorAll(".container").forEach(div => div.classList.add("hidden"));
    document.getElementById(pageId).classList.remove("hidden");
  }
  function openForm() { showPage("formPage"); }
  function backToHome() { showPage("homePage"); }
  function backToForm() { showPage("formPage"); }
  function openContactPage() {
    showPage("contactPage");
    document.getElementById("menuDropdown").classList.add("hidden");
  }
  function toggleMenu() {
    document.getElementById("menuDropdown").classList.toggle("hidden");
  }

  // Key Label + Emoji
  const keyMap = {
    gamertag: "Nama Gamertag",
    ocname: "Nama Karakter OC",
    race: "Ras",
    class: "Class",
    job: "Job",
    role: "Role Sosial",
    sifat: "Sifat & Kepribadian",
    lore: "Lore & Background",
    tujuan: "Tujuan & Motivasi"
  };

  const emojiMap = {
    gamertag: "🎮",
    ocname: "👤",
    race: "🧬",
    class: "⚔️",
    job: "🔨",
    role: "👑",
    sifat: "🎭",
    lore: "📖",
    tujuan: "🎯"
  };

  // 📊 Statistik Halaman
  function openStatsPage() {
    showPage("statsPage");
    document.getElementById("menuDropdown").classList.add("hidden");

    const dataRaw = localStorage.getItem("pendaftarOCList");
    const dataList = dataRaw ? JSON.parse(dataRaw) : [];

    const html = dataList.map((oc, i) => `
      <div style="border-bottom:1px solid #333; padding:12px 0;">
        <strong>#${i+1} - 👤 ${oc.ocname}</strong><br>
        🎮 Gamertag: ${oc.gamertag}<br>
        🧬 Ras: ${oc.race} | ⚔️ Class: ${oc.class} | 🔨 Job: ${oc.job}<br>
        👑 Role: ${oc.role}<br>
        🎭 <em>Sifat:</em> ${oc.sifat}<br>
        📖 <em>Lore:</em> ${oc.lore}<br>
        🎯 <em>Tujuan:</em> ${oc.tujuan}
      </div>
    `).join("");

    document.getElementById("statsContent").innerHTML = html;
  }

  // ✅ Validasi Form
  function validateFormInputs() {
    const gamertag = document.querySelector('input[name="gamertag"]').value.trim();
    const ocname = document.querySelector('input[name="ocname"]').value.trim();
    const sifat = document.querySelector('textarea[name="sifat"]').value.trim();
    const lore = document.querySelector('textarea[name="lore"]').value.trim();
    const tujuan = document.querySelector('textarea[name="tujuan"]').value.trim();

    const gamertagPattern = /^[a-zA-Z0-9_]{3,16}$/;
    const ocnamePattern = /^[a-zA-Z\s]{3,}$/;

    if (!gamertagPattern.test(gamertag)) {
      alert("Gamertag hanya boleh huruf, angka, dan _ (3-16 karakter)");
      return false;
    }

    if (!ocnamePattern.test(ocname)) {
      alert("Nama OC hanya boleh huruf dan spasi, minimal 3 karakter");
      return false;
    }

    if (sifat.length < 50 || lore.length < 100 || tujuan.length < 50) {
      alert("Pastikan seluruh teks memiliki panjang yang cukup!");
      return false;
    }

    return true;
  }

  // 👁️ Tampilkan Preview
  function showPreview() {
    const form = document.getElementById("ocForm");
    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    if (!validateFormInputs()) return;

    const data = new FormData(form);
    let content = "";
    for (let [key, value] of data.entries()) {
      if (key !== "image") {
        const label = keyMap[key] || key;
        content += `${label}:\n${value}\n\n`;
      }
    }
    document.getElementById("previewContent").innerText = content;
    showPage("previewPage");
  }

  // 📩 Kirim ke Discord
  async function submitToDiscord() {
    const form = document.getElementById("ocForm");
    const data = new FormData(form);

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    if (!validateFormInputs()) return;

    if (!confirm("Apakah kamu yakin ingin mengirim pendaftaran ini?")) return;

    const imageFile = data.get("image");
    if (imageFile && imageFile.name && !imageFile.type.startsWith("image/")) {
      alert("File yang diunggah harus berupa gambar.");
      return;
    }

    const fields = [];
    for (let [key, value] of data.entries()) {
      if (key !== "image" && value.trim() !== "") {
        const emoji = emojiMap[key] || "";
        const label = keyMap[key] || key;
        fields.push({
          name: `${emoji} ${label}`,
          value: value.trim().slice(0, 1024),
          inline: false
        });
      }
    }

    const webhook = "https://discord.com/api/webhooks/1251797537002623067/97qDk77RyP3Wz1c70usLIxFoWz-URJz7rR0jn8kW_loLgLHyLfktLO9QeJHlkyznx3Qj";

    try {
      let response;
      if (imageFile && imageFile.name) {
        const buffer = await imageFile.arrayBuffer();
        const blob = new Blob([buffer], { type: imageFile.type });
        const formData = new FormData();
        formData.append("file", blob, imageFile.name);
        formData.append("payload_json", JSON.stringify({
          username: "EternalSMP OC Register",
          embeds: [{
            title: "🗡️ Pendaftaran Karakter Baru",
            description: "Berikut detail karakter OC yang telah dikirim:",
            color: 0xFFA500,
            fields: fields,
            image: { url: "attachment://" + imageFile.name }
          }]
        }));
        response = await fetch(webhook, { method: "POST", body: formData });
      } else {
        response = await fetch(webhook, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            username: "EternalSMP OC Register",
            embeds: [{
              title: "🗡️ Pendaftaran Karakter Baru",
              description: "Berikut detail karakter OC yang telah dikirim:",
              color: 0xFFA500,
              fields: fields
            }]
          })
        });
      }

      if (!response.ok) {
        const errorText = await response.text();
        throw new Error("Discord Error: " + errorText);
      }

      // Simpan ke localStorage
      const newOC = {
        gamertag: data.get("gamertag"),
        ocname: data.get("ocname"),
        race: data.get("race"),
        class: data.get("class"),
        job: data.get("job"),
        role: data.get("role"),
        sifat: data.get("sifat"),
        lore: data.get("lore"),
        tujuan: data.get("tujuan")
      };

      let list = JSON.parse(localStorage.getItem("pendaftarOCList") || "[]");
      list.push(newOC);
      localStorage.setItem("pendaftarOCList", JSON.stringify(list));

      alert("✅ Pendaftaran berhasil dikirim ke Discord!");
      form.reset();
      showPage("homePage");

    } catch (error) {
      alert("❌ Gagal mengirim ke Discord. Cek konsol untuk detail.");
      console.error("Discord Webhook Error:", error.message);
    }
  }
</script>
</body>
</html>
